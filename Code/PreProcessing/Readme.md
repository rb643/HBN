## Pre-processing pipeline for resting-state and movie watching fMRI

Data were preprocessed using the fMRI Signal Processing Toolbox and the Brain Wavelet Toolbox ([Patel et al. 2016](https://doi.org/10.1016/j.neuroimage.2015.04.052)). Freesurfer reconstructed (recon-all, Freesurfer V6.0) structural skullstripped T1 images were used for alignment and normalisation. Functional data was slice-time corrected, regressed for csf signal and motion parameters (and their first derivatives). Additional denoising was completed using wavelet based despiking. Images were normalised to MNI152 standard space using non-linear warping as implemented in the fMRI Signal Processing Toolbox and executed by AFNI's (v17.0.0) 3DQwarp.

### Seed-based connectivity analysis
Seed-based connectivity analyses was conducted using custom Matlab code (implemented using v2019b) and following the guidelines set out in [Patel & Bullmore 2016](https://www.sciencedirect.com/science/article/pii/S1053811915003523)to include wavelet based estimates of the degrees of freedom. This approach corrects the resulting output seed-based connectivity z-scores for the DoF loss incurred by the denoising (e.g. regions where more signal is removed during denoising are downweighted), thereby providing more control over Type I errors. Voxel-wise DoF's were derived during pre-processing and seed-based correlations at voxel level were multiplied by the square root of the DoF before being Fisher z-transformed. Z-scored SCA maps were smoothed using 4 and 8mm Gaussian kernels prior to statistical analysis to increase the signal-to-noise ratio. 
